# 我的福币页面 (myFub.vue)

## 描述
“我的福币”页面用于展示当前用户的福币余额、排名、任务状态和福币的使用说明。用户可以在此页面查看福币余额及排名信息，并且可以通过点击链接跳转至"福币账单"页面以查看福币交易记录明细，跳转至“每日任务”页面完成任务以获得更多福币。

## 页面结构与功能
1. **用户福币信息展示**：页面顶部包含用户的福币余额和排名信息，包括如下部分：
   - **福币余额**：展示当前用户的福币余额，即用户拥有的福币数量。
   - **用户排名**：显示当前用户的福币排名信息，便于用户了解自己在排行榜中的位置。
   
2. **任务状态显示**：
   - **今日任务状态**：显示用户每日任务的完成状态。若任务未完成，显示“今日任务未完成”按钮，点击后跳转至“每日任务”页面；若任务已完成，则显示“今日任务已完成”。
   - **福币说明**：提供简要的福币用途介绍，告知用户福币的使用途径及获取方式。

3. **页面按钮**：
   - **福币账单按钮**：点击该按钮可以跳转至“福币账单”页面，查看福币收入和支出明细。
   - **每日任务按钮**：显示当前任务的完成状态（“已完成”或“未完成”），点击按钮可跳转到每日任务页面获取更多福币。

## 数据获取与更新
页面通过调用 `getUserFubInfo` 云函数来获取当前用户的福币余额、排名和每日任务状态信息。

## 相关云函数
### getUserFubInfo 云函数
用于从数据库中获取用户福币信息。
- **输入**：
  - `user_id`：用户 ID，用于查询用户相关数据。
- **输出**：
  - `fub`：用户福币余额，表示用户当前拥有的福币数量。
  - `rank`：用户福币排名。
  - `dailyTaskCompleted`：用户今日任务的完成状态（布尔值），用于判断是否显示“已完成”或“未完成”。
- **逻辑**：
  - 查询 `leaderboard` 集合，获取用户的福币余额 `fub` 和排名 `rank`。
  - 查询 `dailytasks` 集合，检查当天任务的完成状态。如果任务完成，将 `dailyTaskCompleted` 设置为 `true`，否则为 `false`。
  - 返回结果包含用户福币余额、排名和任务完成状态，以便前端显示。

该云函数通过查询 `leaderboard `集合获取用户的福币分数并计算排名。然后，它从 `dailytasks `集合获取当日任务的完成情况。最终返回的数据包括用户的福币、排名和每日任务状态信息，以便前端展示。

## 页面交互逻辑
- **跳转至“每日任务”页面**：当用户点击“完成每日任务，可得免费福币”或“今日任务未完成”按钮时，页面会通过 goToDailyTasks 方法触发导航至每日任务页面，便于用户进行任务操作。
- **跳转至“福币账单”页面**：用户点击“福币账单”按钮后，会触发 goToBill 方法，跳转至福币账单页面以查看福币交易记录。
##注意事项
- **任务初始化**：如果数据库中没有每日任务数据，后台应确保 initializeDailyTasks 云函数运行，以便为用户创建系统默认的每日任务。
- **用户数据完整性检查**：在获取用户数据时，应注意检查 leaderboard 集合中是否有对应用户信息，并确保 dailytasks 集合中有当日任务数据。
##小结
“我的福币”页面的主要功能是展示用户福币信息和每日任务状态，并提供跳转到相关页面的按钮。通过云函数获取数据，并确保在数据更新时，用户的福币和任务状态能得到实时反映。
