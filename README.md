**这里只是简单罗列一下，更详细的可以点击进入每个页面的README.md文档进行详细了解**

# 云数据库结构

## 1. 用户集合 (users)
用户集合存储每个用户的基本信息，包括账号、密码和个人资料。

- **字段说明**：
  - `_id`：唯一标识符，由系统自动生成。
  - `account`：用户账号，字符串类型，唯一。
  - `password`：用户密码，存储加密后的密码，字符串类型。
  - `nickname`：用户昵称，字符串类型。
  - `avatar`：用户头像 URL，字符串类型，存储头像文件的路径或链接。
  - `dailyTaskCompleted`：当日任务完成状态，布尔类型，表示用户今日是否已完成所有每日任务。
  - `created_at`：用户注册时间，时间戳类型。

## 2. 排行榜集合 (leaderboard)
排行榜集合记录用户的福币分数及排名信息。

- **字段说明**：
  - `_id`：唯一标识符，由系统自动生成。
  - `user_id`：用户 ID，外键，关联 `users` 集合中的 `_id`。
  - `score`：用户福币分数，数值类型，表示用户当前的福币数量。
  - `rank`：用户在排行榜中的排名，数值类型，系统根据分数动态生成。
  - `updated_at`：分数更新时间，时间戳类型。

## 3. 交易记录集合 (transactions)
交易记录集合用于存储用户的福币收入和支出明细。

- **字段说明**：
  - `_id`：唯一标识符，由系统自动生成。
  - `user_id`：用户 ID，外键，关联 `users` 集合中的 `_id`。
  - `date`：交易日期，时间戳类型，记录交易发生的时间。
  - `description`：交易描述，字符串类型，描述交易的类型（例如“任务奖励”或“福币消费”）。
  - `amount`：交易福币数量，数值类型，收入为正数，支出为负数。

## 4. 每日任务集合 (dailytasks)
每日任务集合记录用户的每日任务信息，包括任务完成状态和福币奖励。

- **字段说明**：
  - `_id`：唯一标识符，由系统自动生成。
  - `user_id`：用户 ID，外键，关联 `users` 集合中的 `_id`。
  - `date`：任务日期，字符串类型，记录任务创建的日期（格式如 `YYYY-MM-DD`）。
  - `name`：任务名称，字符串类型，描述任务内容。
  - `reward`：任务奖励，数值类型，表示完成任务后获得的福币数量。
  - `completed`：任务完成状态，布尔类型，`true` 表示已完成，`false` 表示未完成。

---

## 小结
- `users` 集合用于存储用户的基础信息。
- `leaderboard` 集合用于记录用户的福币排名和分数。
- `transactions` 集合用于记录用户的福币交易明细，方便用户追踪福币变化。
- `dailytasks` 集合用于记录用户的每日任务，任务完成后奖励福币并更新状态。



# 页面结构

## 1. 欢迎页面 (welcome.vue)
欢迎页面是用户首次打开应用时看到的页面，提供简洁的欢迎信息，并引导用户进行登录或注册。

- **结构**：
  - **欢迎信息**：简短的欢迎文字，营造友好的初始体验。
  - **按钮**：
    - **登录按钮**：跳转至登录页面。
    - **注册按钮**：跳转至注册页面。
    
- **主要功能**：
  - 引导用户进入登录或注册流程。

---

## 2. 登录页面 (login.vue)
登录页面用于验证已注册用户的账号和密码，确保用户身份。

- **结构**：
  - **账号输入框**：输入用户账号。
  - **密码输入框**：输入用户密码，隐藏输入内容。
  - **按钮**：
    - **登录按钮**：提交账号和密码进行验证。
    - **注册链接**：跳转至注册页面，便于新用户注册。

- **主要功能**：
  - 验证用户身份，允许已注册用户登录应用。

---

## 3. 注册页面 (register.vue)
注册页面用于新用户创建账号，通过输入账号和密码完成注册。

- **结构**：
  - **账号输入框**：输入用户自定义账号。
  - **密码输入框**：输入密码，隐藏输入内容。
  - **确认密码输入框**：再次输入密码，确保两次输入一致。
  - **按钮**：
    - **注册按钮**：提交账号和密码信息完成注册。
    - **登录链接**：跳转至登录页面。

- **主要功能**：
  - 检查账号唯一性和密码一致性，创建新用户账户。

---

## 4. 完善个人资料页面 (profileComplete.vue)
完善个人资料页面用于在新用户注册后补充昵称和头像信息，以个性化用户档案。
**标注一下：头像上传有问题（后续解决）**

- **结构**：
  - **昵称输入框**：输入用户的昵称。
  - **头像上传**：上传用户头像。
  - **完成按钮**：提交资料更新信息。

- **主要功能**：
  - 补充用户档案信息，使用户资料更加完整。

---

## 5. 福币排行榜页面 (leaderboard.vue)
福币排行榜页面展示福币积分排名前 10 的用户信息，以及当前用户的排名和分数。
**标注一下：背景图片显示有问题（后续解决）**

- **结构**：
  - **前 10 名用户列表**：显示用户头像、昵称、福币数量和排名。
  - **当前用户信息**：突出显示当前用户的福币余额和排名。

- **主要功能**：
  - 展示用户排名情况，激励用户完成更多任务。

---

## 6. 我的福币页面 (myFub.vue)
我的福币页面展示当前用户的福币余额、排名及任务状态，并提供福币使用说明。

- **结构**：
  - **福币信息**：包括用户的福币余额和排名。
  - **任务状态**：显示今日任务的完成状态。
  - **按钮**：
    - **福币账单按钮**：跳转至福币账单页面。
    - **每日任务按钮**：跳转至每日任务页面。
  - **福币使用说明**：描述福币的使用方式。

- **主要功能**：
  - 展示用户福币信息，提供任务及账单的入口。

---

## 7. 福币账单页面 (fubBill.vue)
福币账单页面用于展示用户的福币交易记录，包括日期、描述和福币变动情况。

- **结构**：
  - **交易记录列表**：按日期倒序显示每笔交易的日期、描述和福币数量。
  
- **主要功能**：
  - 让用户清晰了解福币的收入和支出明细。

---

## 8. 每日任务页面 (dailyTasks.vue)
每日任务页面展示用户的当日任务列表，用户可在此页面完成任务以获取福币奖励。

- **结构**：
  - **任务列表**：每个任务项包含任务编号、名称、奖励和完成状态。
  - **任务状态切换**：点击任务项可切换任务完成状态。

- **主要功能**：
  - 展示用户每日任务，并在任务完成时更新福币数量。


# 云函数结构

## 1. 用户登录 (userLogin)
验证用户的账号和密码，确保登录信息的准确性并生成用户会话。

- **输入**：
  - `account`：用户账号。
  - `password`：用户密码。
  
- **输出**：
  - 成功返回用户的 `user_id`；失败时返回错误信息。
  
- **主要逻辑**：
  - 在 `users` 集合中查找匹配账号和密码的记录。
  - 如果验证成功，返回用户的 `user_id`，以便前端存储并保持登录状态。

---

## 2. 用户注册 (userRegister)
注册新用户并将账号和密码存储在数据库中。

- **输入**：
  - `account`：用户账号。
  - `password`：用户密码。
  
- **输出**：
  - 成功返回用户的 `user_id` 和注册成功信息；若失败则返回错误信息。
  
- **主要逻辑**：
  - 检查 `users` 集合中是否存在重复的账号，确保唯一性。
  - 若账号可用，将账号和加密后的密码存入 `users` 集合中，并返回新用户的 `user_id`。

---

## 3. 完善个人资料 (completeProfile)
用于补充注册用户的个人资料信息，如昵称和头像。

- **输入**：
  - `user_id`：用户 ID。
  - `nickname`：用户昵称。
  - `avatar`：用户头像 URL。
  
- **输出**：
  - 成功返回更新后的用户资料信息；若失败则返回错误信息。
  
- **主要逻辑**：
  - 使用 `user_id` 查找 `users` 集合中的记录，并更新用户的昵称和头像字段。
  - 成功后返回用户的完整资料信息，以便前端更新显示。

---

## 4. 获取排行榜数据 (getLeaderboard)
获取福币积分排名前 10 名的用户数据，以及当前用户的排名信息。

- **输入**：
  - `user_id`：当前用户的 ID。
  
- **输出**：
  - 前 10 名用户列表及当前用户的福币信息和排名。
  
- **主要逻辑**：
  - 查询 `leaderboard` 集合中的前 10 名用户信息，按分数降序排列。
  - 获取当前用户的福币数和排名数据，并与前 10 名列表一同返回。

---

## 5. 获取每日任务 (getDailyTasks)
获取用户当日任务的详细信息，包括任务状态和奖励。

- **输入**：
  - `user_id`：用户 ID。
  
- **输出**：
  - 用户当天的任务列表，每个任务包含名称、奖励和完成状态。
  
- **主要逻辑**：
  - 查询 `dailytasks` 集合中指定 `user_id` 和当日日期的任务信息，并返回任务列表。

---

## 6. 获取用户福币信息 (getUserFubInfo)
获取用户当前福币余额、排名及任务完成状态。

- **输入**：
  - `user_id`：用户 ID。
  
- **输出**：
  - 用户的福币余额、排名和当日任务完成状态。
  
- **主要逻辑**：
  - 查询 `leaderboard` 集合中用户的福币余额和排名。
  - 检查 `dailytasks` 集合中当日任务的完成情况。

---

## 7. 获取用户交易记录 (getUserTransactions)
获取用户的福币交易历史记录，包括每笔交易的日期、描述和福币数量变动。

- **输入**：
  - `user_id`：用户 ID。
  
- **输出**：
  - 用户的福币交易记录列表。
  
- **主要逻辑**：
  - 查询 `transactions` 集合中的交易记录，按日期倒序排列后返回。

---

## 8. 更新任务状态 (updateTaskStatus)
用于切换用户每日任务的完成状态，并根据完成情况更新福币余额。

- **输入**：
  - `task_id`：任务 ID。
  - `user_id`：用户 ID。
  - `completed`：任务完成状态（布尔值）。
  
- **输出**：
  - 成功更新后的福币余额；失败时返回错误信息。
  
- **主要逻辑**：
  - 在 `dailytasks` 集合中更新任务的完成状态。
  - 如果任务完成，增加用户的福币分数；如果取消完成状态，则扣除相应福币分数。
  - 更新 `leaderboard` 集合中的福币余额，并返回新的余额。

---

## 9. 初始化每日任务 (initializeDailyTasks)
用于在数据库中无每日任务记录时，为新用户生成默认的每日任务。

- **输入**：
  - `user_id`：用户 ID。
  
- **输出**：
  - 初始任务列表。
  
- **主要逻辑**：
  - 在 `dailytasks` 集合中为该用户创建当天的默认任务，并设置默认完成状态为 `false`。
  - 返回初始化后的任务列表以供展示。

## 10. 获取头像 URL 或更新头像 URL (getAndUpdateAvatarUrl)
用于获取用户的头像 URL，并检查是否需要更新 URL。若头像字段中存储的是文件 ID，则生成临时 URL 并更新到用户记录中，以确保头像的可访问性。

- **输入**：
  - `user_id`：用户 ID，用于查找对应的用户记录。
  
- **输出**：
  - 成功时返回用户的头像 URL；若头像生成失败则返回错误信息。
  
- **主要逻辑**：
  - 查询 `users` 集合，获取用户的头像 URL。
  - 如果 URL 是文件 ID 格式（非 HTTP/HTTPS 开头），则生成临时 URL 以供前端显示。
  - 将生成的临时 URL 更新到用户记录中，以确保头像地址保持可访问状态。

---

## 11. 更新用户福币分数 (updateUserScore)
用于更新用户的福币分数，支持增加或减少分数，并自动在 `leaderboard` 集合中添加或更新记录。

- **输入**：
  - `user_id`：用户 ID，标识需要更新分数的用户。
  - `scoreChange`：分数变化量（正数表示增加，负数表示减少）。
  
- **输出**：
  - 成功时返回更新成功的消息；若更新失败则返回错误信息。
  
- **主要逻辑**：
  - 查询 `leaderboard` 集合，检查用户的分数记录是否存在。
  - 若不存在该用户记录，则新建一条记录并设定初始分数。
  - 若记录存在，则根据 `scoreChange` 值更新用户的福币分数，并存储更新后的结果。
